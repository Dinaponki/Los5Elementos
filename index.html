<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Descargar V1.0</title>
  <meta name="theme-color" content="#07110a">
  <style>
    /* Reset simple */
    *{box-sizing:border-box;margin:0;padding:0}
    html,body{height:100%;width:100%;overflow:hidden}
    body{
      font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      color:#dfffe6;
      background:linear-gradient(180deg,#000000 0%, #021006 30%, #03120a 100%); /* minimal black->dark green */
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      display:flex;
      flex-direction:column;
      min-height:100vh;
      align-items:stretch;
      justify-content:flex-start;
    }

    /* Keep everything inside viewport: no scrollbar. Images scale by viewport height. */
    header.site-header{
      padding:18px 16px 6px;
      z-index:10; /* above overlay */
      flex:0 0 auto;
    }
    header.site-header .site-title{
      display:block;margin:0 auto;text-align:center;max-width:92vw;
      /* entrance from top + continuous subtle pulse */
      animation:slideDownIn .7s cubic-bezier(.2,.9,.3,1) both, pulse 2.6s ease-in-out 0.9s infinite;
      will-change:transform,opacity;
    }
    /* Prevent distortion: keep aspect ratio and increase size so it se vea perfecto */
    header.site-header .site-title img{
      display:block;width:auto !important; /* override width/height attributes */
      height:auto !important;
      max-width:92vw;
      max-height:30vh; /* enlarged title for better presence */
      margin:0 auto;object-fit:contain;image-rendering:auto;
      filter:drop-shadow(0 6px 10px rgba(0,0,0,0.6));
    }

    /* Changelog area below the title - editable in-browser (contenteditable) */
    .changelog{
      margin:10px auto 0;max-width:88vw;text-align:left;color:rgba(223,255,230,0.95);
      font-size:0.95rem;line-height:1.35;padding:8px 12px;border-radius:8px;opacity:0.98;
      background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      box-shadow: 0 6px 18px rgba(2,6,3,0.45);
      max-height:16vh;overflow:hidden; /* ensure no scrollbar in page */
    }
    .changelog ul{padding-left:18px;margin:6px 0}
    .changelog:focus{outline:2px dashed rgba(255,255,255,0.08)}

    main.site-main{flex:1 1 auto;display:flex;align-items:center;justify-content:center;padding:18px 24px;z-index:10}

    /* Download button as an anchor for native download support */
    .download-wrap{display:flex;flex-direction:column;align-items:center;gap:10px}

    /* Button container to hold exact visual layers */
    .download-btn{
      display:inline-flex;align-items:center;justify-content:center;
      text-decoration:none;font-weight:700;padding:14px 34px;border-radius:14px;font-size:1.15rem;min-width:220px;
      background:linear-gradient(180deg, rgba(38,195,85,0.98) 0%, rgba(22,150,62,0.98) 100%); /* green gradient */
      color:#ffffff;cursor:pointer;transition:transform .18s ease,box-shadow .18s ease,opacity .12s ease;
      border-radius:12px;position:relative;z-index:1;
      /* thick white border using outline so it doesn't change layout */
      outline:6px solid #ffffff;
      /* thin black outer contour */
      box-shadow: 0 10px 28px rgba(8,20,10,0.6), 0 0 0 2px #000;
      -webkit-font-smoothing:antialiased;text-rendering:optimizeLegibility;
      line-height:1; /* avoid vertical misalignment */
    }

    /* Inner text layer: white text with crisp black stroke simulated via multiple 1px offsets (no blurring) */
    .download-btn .btn-text{
      position:relative;z-index:2;color:#ffffff;font-weight:800;letter-spacing:0.2px;
      -webkit-text-stroke:0px transparent; /* avoid browser stroke artifacts */
      text-shadow:
        -1px -1px 0 #000, 1px -1px 0 #000,
        -1px 1px 0 #000, 1px 1px 0 #000; /* 1px hard outline */
      padding:6px 0;display:inline-block;
    }

    /* Remove weirdness on small screens: slightly reduce shadow and border width */
    @media (max-width:640px){
      header.site-header{padding-top:12px}
      header.site-header .site-title img{max-height:24vh}
      .download-btn{padding:12px 20px;font-size:1rem;min-width:160px;border-radius:12px;outline-width:5px;box-shadow:0 8px 22px rgba(8,20,10,0.5), 0 0 0 1.5px #000}
      .changelog{font-size:0.9rem;max-height:20vh}
    }

    .download-btn:active{transform:translateY(1px) scale(.998)}
    .download-btn:focus{outline:none;box-shadow:0 0 0 10px rgba(28,145,76,0.12)}

    .btn-sub{display:block;text-align:center;font-size:.86rem;opacity:.86;color:rgba(223,255,230,0.9)}

    @media (min-width:1400px){
      header.site-header .site-title img{max-height:34vh}
    }

    /* Small manual fallback overlay when popups are blocked (only appears if needed) */
    .fallback-overlay{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:rgba(2,5,2,0.6);z-index:9999}
    .fallback-card{background:linear-gradient(180deg, #041008, #021006);border-radius:12px;padding:18px 20px;max-width:92vw;color:#dfffe6;text-align:center;box-shadow:0 12px 40px rgba(0,0,0,0.6)}
    .fallback-card a{display:inline-block;margin-top:10px;padding:10px 18px;border-radius:10px;background:#0b5f2b;color:#fff;text-decoration:none;border:2px solid #fff}

    /* Toast */
    .toast{position:fixed;left:50%;transform:translateX(-50%);bottom:28px;padding:10px 14px;border-radius:10px;background:rgba(0,0,0,0.6);color:#dfffe6;font-size:.95rem;z-index:50;display:none}

    /* Animations */
    @keyframes slideDownIn{
      0%{opacity:0;transform:translateY(-30px)}
      100%{opacity:1;transform:translateY(0)}
    }
    @keyframes slideUpIn{
      0%{opacity:0;transform:translateY(30px)}
      100%{opacity:1;transform:translateY(0)}
    }
    @keyframes pulse{
      0%{transform:scale(1)}
      50%{transform:scale(1.025)}
      100%{transform:scale(1)}
    }

    /* Make sure no accidental scrollbar due to focus outlines: use outline-offset where needed */
    a:focus{outline-offset:4px}
  </style>
</head>
<body>
  <!-- Title image (title.png) must be placed alongside index.html -->
  <header class="site-header">
    <div class="site-title" role="img" aria-label="Título del sitio">
      <img src="title.png" alt="Título" width="1088" height="960">
    </div>

    <!-- Editable changelog: edítalo directamente aquí (no se guarda en el servidor) o modifica el HTML y vuelve a subir el archivo -->
    <div class="changelog" id="changelog" contenteditable="true" aria-label="Registro de cambios. Edita para listar lo nuevo en esta versión">
      <strong>Registro de cambios — Versión 1.0</strong>
      <ul>
        <li>Los árboles vecinos se incendian/apagan correctamente con el encendedor/balde de agua.</li>
        <li>Mejora en la estabilidad y la suavidad de los movimientos del nivel.</li>
        <li>Panel de "Cómo jugar" actualizado (Optimización necesaria).</li>
        <li>Precios de vidas y boosts actualizados.</li>
        <li>Temporizador de vidas eliminado.</li>
        <li>Superposición de elementos parcheado temporalmente</li>
        <li>Anuncios congelados parcheado temporalmente</li>
        <li>Al salir del juego durante un nivel o el panel de derrota, al volver a iniciar se mostrará el último nivel jugado.</li>
        
      </ul>
    </div>
  </header>

  <main class="site-main">
    <!-- The anchor now points to your Google Drive view link but JS will open a direct-drive download in a NEW TAB. It never navigates the current page. -->
    <div class="download-wrap" style="text-align:center">
      <a id="downloadLink" class="download-btn" href="https://drive.google.com/file/d/1KgQhylKeJ4A_bazb6IAUrQyET86mZiYw/view?usp=sharing" target="_blank" rel="noopener noreferrer" aria-label="Descargar Los 5 Elementos versión 1.0 (Google Drive)">
        <span class="btn-text">Descargar V1.0</span>
      </a>
      <div class="btn-sub">Archivo: <strong>Los 5 Elementos.apk</strong></div>
    </div>
  </main>

  <div class="bg-overlay" aria-hidden="true"></div>
  <div id="toast" class="toast" role="status" aria-live="polite"></div>

  <!-- Manual fallback overlay (appears only if popup is blocked) -->
  <div id="fallback" class="fallback-overlay" role="dialog" aria-hidden="true">
    <div class="fallback-card">
      <div>El navegador bloqueó la apertura automática en una nueva pestaña.</div>
      <div style="margin-top:8px">Haz clic en el botón de abajo para abrir Google Drive en una pestaña nueva y descargar el APK.</div>
      <a id="fallbackLink" href="#" target="_blank" rel="noopener noreferrer">Abrir Google Drive (nueva pestaña)</a>
      <div style="margin-top:10px;font-size:.9rem;opacity:.9">Si esto no funciona, permite ventanas emergentes o abre manualmente el enlace.</div>
    </div>
  </div>

  <script>
    (function(){
      const link = document.getElementById('downloadLink');
      const toast = document.getElementById('toast');
      const fallback = document.getElementById('fallback');
      const fallbackLink = document.getElementById('fallbackLink');

      // Google Drive file id (from the link you provided)
      const DRIVE_ID = '1KgQhylKeJ4A_bazb6IAUrQyET86mZiYw';
      const DRIVE_DIRECT = `https://drive.google.com/uc?export=download&id=${DRIVE_ID}`;
      const DRIVE_VIEW = link.getAttribute('href');

      function showToast(text, timeout=2400){
        toast.textContent = text; toast.style.display = 'block';
        clearTimeout(toast._t);
        toast._t = setTimeout(()=> toast.style.display = 'none', timeout);
      }

      // helper to show manual fallback card
      function showFallback(url){
        fallbackLink.href = url || DRIVE_VIEW;
        fallback.style.display = 'flex';
        fallback.setAttribute('aria-hidden','false');
      }

      link.addEventListener('click', function(e){
        // Always open in a new tab/window only — never navigate current page.
        e.preventDefault();

        // First try direct-download URL (works in many browsers)
        const opened = window.open(DRIVE_DIRECT, '_blank', 'noopener');
        if(opened){
          showToast('Se abrió Google Drive en una pestaña; la descarga debería comenzar allí.');
          return;
        }

        // If popup blocked, try opening the view link
        const opened2 = window.open(DRIVE_VIEW, '_blank', 'noopener');
        if(opened2){
          showToast('Se abrió la vista de Google Drive en una pestaña nueva.');
          return;
        }

        // If still blocked, show manual overlay with a clickable link (user must click)
        showToast('Popup bloqueado — por favor, abre el enlace manualmente.');
        showFallback(DRIVE_DIRECT);
      });

      // Accessibility: Allow Enter/Space to trigger when focused
      link.addEventListener('keydown', function(e){
        if(e.key === 'Enter' || e.key === ' '){ e.preventDefault(); this.click(); }
      });

      // Clicking outside fallback closes it
      fallback.addEventListener('click', (ev)=>{
        if(ev.target === fallback){ fallback.style.display='none'; fallback.setAttribute('aria-hidden','true'); }
      });

    })();
  </script>
</body>
</html>


