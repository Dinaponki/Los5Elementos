<!doctype html>
<html lang="es">
<head>
  <link rel="icon" type="image/x-icon" href="favicon.ico">
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Descargar V1.0</title>
  <meta name="theme-color" content="#07110a">
  <style>
    /* Reset */
    *{box-sizing:border-box;margin:0;padding:0}
    html,body{height:100%;width:100%;overflow:hidden}
    body{
      font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      color:#dfffe6;
      background:linear-gradient(180deg,#000000 0%, #021006 28%, #03210c 100%);
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      display:flex;align-items:center;justify-content:center;
      padding:24px;min-height:100vh;
    }

    /* Central card that keeps everything centered and responsive */
    .card{
      width:min(980px,96vw);
      background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      border-radius:14px;padding:22px;box-shadow:0 18px 50px rgba(0,0,0,0.65);backdrop-filter:blur(6px);
      display:grid;grid-template-rows:auto 1fr auto;gap:18px;align-items:center;
    }

    /* Title */
    .title-wrap{display:flex;align-items:center;justify-content:center;gap:12px}
    .site-title img{max-width:88vw;height:auto;width:auto;max-height:36vh;display:block;object-fit:contain}

    /* Changelog: visible, read-only, scrolls inside */
    .changelog{
      color:rgba(223,255,230,0.98);font-size:1rem;line-height:1.45;padding:12px;border-radius:10px;
      background:linear-gradient(180deg, rgba(0,0,0,0.16), rgba(0,0,0,0.08));
      box-shadow:inset 0 1px 0 rgba(255,255,255,0.02);
      overflow:auto;max-height:34vh;
    }
    .changelog strong{display:block;margin-bottom:8px;font-size:1.05rem}
    .changelog ul{padding-left:18px;margin-top:6px}

    /* Centered area for download */
    .download-area{display:flex;flex-direction:column;align-items:center;gap:10px;padding-bottom:6px}
    .download-btn{
      -webkit-font-smoothing:antialiased;text-rendering:optimizeLegibility;
      appearance:none;border:0;cursor:pointer;user-select:none;
      display:inline-flex;align-items:center;justify-content:center;
      padding:14px 36px;border-radius:14px;font-weight:800;font-size:1.15rem;min-width:220px;
      color:#fff;background:linear-gradient(180deg,#2fc45a 0%,#1da142 100%);
      box-shadow:0 18px 40px rgba(8,20,10,0.55), 0 0 0 2px #000 inset;outline:6px solid #fff;
      position:relative;z-index:2;transition:transform .14s ease,box-shadow .14s ease;
    }
    .download-btn:active{transform:translateY(1px) scale(.997)}
    .download-btn:focus{outline:none;box-shadow:0 0 0 10px rgba(28,145,76,0.12)}

    .btn-text{position:relative;z-index:3;color:#fff;text-shadow:-1px -1px 0 #000,1px -1px 0 #000,-1px 1px 0 #000,1px 1px 0 #000}
    .btn-sub{font-size:.88rem;opacity:.88;color:rgba(223,255,230,0.9)}

    /* Responsive tweaks */
    @media (max-width:720px){
      .card{padding:14px}
      .site-title img{max-height:26vh}
      .download-btn{padding:12px 22px;font-size:1rem;min-width:180px}
      .changelog{max-height:30vh;font-size:0.95rem}
    }

    @media (min-width:1400px){
      .site-title img{max-height:40vh}
      .changelog{max-height:40vh}
    }

    /* Fallback overlay */
    .fallback-overlay{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:rgba(2,5,2,0.66);z-index:9999}
    .fallback-card{background:linear-gradient(180deg,#041008,#021006);padding:18px;border-radius:12px;color:#dfffe6;max-width:92vw;text-align:center}
    .fallback-card a{display:inline-block;margin-top:12px;padding:10px 16px;border-radius:8px;background:#0b5f2b;color:#fff;text-decoration:none;border:2px solid #fff}

    /* Simple toast */
    .toast{position:fixed;left:50%;transform:translateX(-50%);bottom:26px;padding:8px 12px;border-radius:9px;background:rgba(0,0,0,0.6);color:#dfffe6;z-index:60;display:none}
  </style>
</head>
<body>
  <div class="card" role="main" aria-label="Panel principal de descarga">
    <div class="title-wrap">
      <div class="site-title" aria-hidden="false">
        <img src="title.png" alt="Título del juego">
      </div>
    </div>

    <div class="changelog" id="changelog" aria-label="Registro de cambios">
      <strong>Registro de cambios — Versión 1.0</strong>
      <ul>
        <li>Los árboles vecinos se incendian/apagan correctamente con el encendedor/balde de agua.</li>
        <li>Mejora en la estabilidad y la suavidad de los movimientos del nivel.</li>
        <li>Panel de "Cómo jugar" actualizado (Optimización necesaria).</li>
        <li>Precios de vidas y boosts actualizados.</li>
        <li>Temporizador de vidas eliminado.</li>
        <li>Superposición de elementos parcheado temporalmente</li>
        <li>Anuncios congelados parcheado temporalmente</li>
        <li>Al salir del juego durante un nivel o el panel de derrota, al volver a iniciar se mostrará el último nivel jugado.</li>
      </ul>
    </div>

    <div class="download-area">
      <button id="downloadBtn" class="download-btn" aria-label="Descargar Los 5 Elementos.apk">
        <span class="btn-text">Descargar V1.0</span>
      </button>
      <div class="btn-sub">Archivo: <strong>Los 5 Elementos.apk</strong></div>
    </div>
  </div>

  <div id="fallback" class="fallback-overlay" role="dialog" aria-hidden="true">
    <div class="fallback-card">
      <div>El navegador bloqueó la apertura automática en una nueva pestaña.</div>
      <div style="margin-top:8px">Haz clic en el botón de abajo para abrir Google Drive en una pestaña nueva y descargar el APK.</div>
      <a id="fallbackLink" href="#" target="_blank" rel="noopener noreferrer">Abrir Google Drive (nueva pestaña)</a>
      <div style="margin-top:10px;font-size:.9rem;opacity:.9">Si esto no funciona, permite ventanas emergentes o abre manualmente el enlace.</div>
    </div>
  </div>

  <div id="toast" class="toast" role="status" aria-live="polite"></div>

  <script>
    (function(){
      const btn = document.getElementById('downloadBtn');
      const toast = document.getElementById('toast');
      const fallback = document.getElementById('fallback');
      const fallbackLink = document.getElementById('fallbackLink');

      const DRIVE_ID = '1KgQhylKeJ4A_bazb6IAUrQyET86mZiYw';
      const DRIVE_VIEW = `https://drive.google.com/file/d/${DRIVE_ID}/view?usp=sharing`;

      let opening = false; // prevents double-open

      function showToast(text, time=2000){
        toast.textContent = text; toast.style.display='block'; clearTimeout(toast._t);
        toast._t = setTimeout(()=> toast.style.display='none', time);
      }

      function showFallback(url){
        fallbackLink.href = url || DRIVE_VIEW; fallback.style.display='flex'; fallback.setAttribute('aria-hidden','false');
      }

      function openInNewTab(url){
        // try to open once and return boolean
        try{
          const w = window.open(url, '_blank', 'noopener');
          return !!w;
        }catch(e){
          return false;
        }
      }

      btn.addEventListener('click', function(e){
        e.preventDefault();
        if(opening) return; // already trying
        opening = true;

        // first attempt: open the view link in a new tab (single action)
        const ok = openInNewTab(DRIVE_VIEW);
        if(ok){ showToast('Se abrió Google Drive en una pestaña nueva.'); opening = false; return; }

        // fallback: popup blocked -> show overlay with manual link
        showToast('Popup bloqueado — por favor, abre el enlace manualmente.');
        showFallback(DRIVE_VIEW);
        opening = false;
      });

      // keyboard accessibility
      btn.addEventListener('keydown', function(e){ if(e.key==='Enter' || e.key===' '){ e.preventDefault(); btn.click(); } });

      // close fallback when clicking outside
      fallback.addEventListener('click', function(ev){ if(ev.target===fallback){ fallback.style.display='none'; fallback.setAttribute('aria-hidden','true'); } });

      // set fallback link
      fallbackLink.href = DRIVE_VIEW;
    })();
  </script>
</body>
</html>






